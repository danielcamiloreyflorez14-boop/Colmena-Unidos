<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#111827" />
  <title>Colmena Unidos | Editor de Recintos</title>
  <meta name="description" content="Editor visual de recintos para eventos: sillas, mesas, escenarios, zonas y preparaci√≥n de venta de entradas." />

  <!-- CSS -->
  <link rel="stylesheet" href="css/main.css?v=1" />

  <!-- Favicons opcionales (puedes a√±adirlos despu√©s) -->
  <!-- <link rel="icon" href="assets/favicon.ico" /> -->
</head>

<body>
  <!-- =========================================================
       HEADER / TOP BAR
  ========================================================== -->
  <header class="topbar" id="topbar">
    <div class="topbar__left">
      <div class="brand" aria-label="Marca">
        <div class="brand__logo" aria-hidden="true">CU</div>
        <div class="brand__text">
          <div class="brand__title">Colmena Unidos</div>
          <div class="brand__subtitle">Editor de Recintos</div>
        </div>
      </div>

      <div class="project-meta" aria-label="Informaci√≥n del proyecto">
        <div class="project-meta__item">
          <span class="badge" id="appStatusBadge">MVP</span>
        </div>
        <div class="project-meta__item">
          <span class="muted">Evento:</span>
          <strong id="eventNameLabel">Sin nombre</strong>
        </div>
        <div class="project-meta__item">
          <span class="muted">Modo:</span>
          <strong id="modeLabel">Edici√≥n</strong>
        </div>
      </div>
    </div>

    <div class="topbar__right">
      <button class="btn btn--ghost" id="btnHelp" type="button" title="Ayuda (atajos y gu√≠a)">
        Ayuda
      </button>

      <button class="btn btn--ghost" id="btnShortcuts" type="button" title="Ver atajos de teclado">
        Atajos
      </button>

      <div class="divider" aria-hidden="true"></div>

      <button class="btn btn--ghost" id="btnUndo" type="button" title="Deshacer (Ctrl+Z)">
        Deshacer
      </button>
      <button class="btn btn--ghost" id="btnRedo" type="button" title="Rehacer (Ctrl+Y)">
        Rehacer
      </button>

      <div class="divider" aria-hidden="true"></div>

      <button class="btn" id="btnSave" type="button" title="Guardar dise√±o en este navegador">
        Guardar
      </button>
      <button class="btn btn--ghost" id="btnLoad" type="button" title="Cargar el √∫ltimo dise√±o guardado">
        Cargar
      </button>

      <button class="btn btn--danger" id="btnClear" type="button" title="Limpiar todo el plano">
        Limpiar
      </button>
    </div>
  </header>

  <!-- =========================================================
       MAIN LAYOUT
  ========================================================== -->
  <div class="app" id="appRoot">
    <!-- =======================================================
         LEFT SIDEBAR: TOOLS + SETTINGS
    ======================================================== -->
    <aside class="sidebar" id="leftSidebar" aria-label="Herramientas y configuraci√≥n">
      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Herramientas</h2>
          <p class="panel__hint">Selecciona y pinta sobre el plano.</p>
        </div>

        <div class="toolgrid" role="group" aria-label="Selector de herramienta">
          <button class="tool" id="toolSeat" type="button" data-tool="seat" aria-pressed="true" title="Silla">
            <span class="tool__icon" aria-hidden="true">üü©</span>
            <span class="tool__label">Silla</span>
          </button>

          <button class="tool" id="toolTable" type="button" data-tool="table" aria-pressed="false" title="Mesa">
            <span class="tool__icon" aria-hidden="true">üü¶</span>
            <span class="tool__label">Mesa</span>
          </button>

          <button class="tool" id="toolStage" type="button" data-tool="stage" aria-pressed="false" title="Escenario">
            <span class="tool__icon" aria-hidden="true">üüß</span>
            <span class="tool__label">Escenario</span>
          </button>

          <button class="tool" id="toolWall" type="button" data-tool="wall" aria-pressed="false" title="Bloque/Obst√°culo">
            <span class="tool__icon" aria-hidden="true">‚¨õ</span>
            <span class="tool__label">Bloque</span>
          </button>

          <button class="tool" id="toolAisle" type="button" data-tool="aisle" aria-pressed="false" title="Pasillo">
            <span class="tool__icon" aria-hidden="true">‚¨ú</span>
            <span class="tool__label">Pasillo</span>
          </button>

          <button class="tool tool--danger" id="toolErase" type="button" data-tool="erase" aria-pressed="false" title="Borrar">
            <span class="tool__icon" aria-hidden="true">üßΩ</span>
            <span class="tool__label">Borrar</span>
          </button>
        </div>

        <div class="panel__footer">
          <div class="row row--gap">
            <button class="btn btn--ghost" id="btnSelectMode" type="button" title="Modo selecci√≥n (seleccionar celdas)">
              Modo Selecci√≥n
            </button>
            <button class="btn btn--ghost" id="btnPaintMode" type="button" title="Modo pintar (herramientas)">
              Modo Pintar
            </button>
          </div>

          <div class="row row--gap">
            <label class="check">
              <input id="chkShowNumbers" type="checkbox" checked />
              <span>Mostrar n√∫meros</span>
            </label>
            <label class="check">
              <input id="chkSnap" type="checkbox" checked />
              <span>Snap</span>
            </label>
          </div>

          <div class="row row--gap">
            <label class="check">
              <input id="chkAutoNumber" type="checkbox" checked />
              <span>Auto-numerar</span>
            </label>
            <label class="check">
              <input id="chkContinuousPaint" type="checkbox" checked />
              <span>Pintar arrastrando</span>
            </label>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Plano</h2>
          <p class="panel__hint">Tama√±o del grid y configuraci√≥n.</p>
        </div>

        <div class="form">
          <div class="field">
            <label for="eventNameInput">Nombre del evento</label>
            <input id="eventNameInput" type="text" placeholder="Ej: Boxeo - Noche de Campeones" maxlength="80" />
          </div>

          <div class="field field--two">
            <div>
              <label for="rowsInput">Filas</label>
              <input id="rowsInput" type="number" min="5" max="80" value="25" />
            </div>
            <div>
              <label for="colsInput">Columnas</label>
              <input id="colsInput" type="number" min="5" max="80" value="25" />
            </div>
          </div>

          <div class="field">
            <label for="gridPreset">Preset</label>
            <select id="gridPreset">
              <option value="custom" selected>Personalizado</option>
              <option value="small">Peque√±o (15x15)</option>
              <option value="medium">Medio (25x25)</option>
              <option value="large">Grande (35x35)</option>
              <option value="wide_stage">Con escenario frontal (25x35)</option>
              <option value="ring_center">Ring/centro (30x30)</option>
            </select>
          </div>

          <div class="row row--gap">
            <button class="btn" id="btnApplyGrid" type="button">Aplicar tama√±o</button>
            <button class="btn btn--ghost" id="btnCenterView" type="button">Centrar vista</button>
          </div>

          <div class="row row--gap">
            <button class="btn btn--ghost" id="btnZoomOut" type="button">Zoom -</button>
            <button class="btn btn--ghost" id="btnZoomReset" type="button">Zoom 100%</button>
            <button class="btn btn--ghost" id="btnZoomIn" type="button">Zoom +</button>
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Zonas y precios</h2>
          <p class="panel__hint">Preparaci√≥n de venta (sin cobrar todav√≠a).</p>
        </div>

        <div class="form">
          <div class="field">
            <label for="zoneSelect">Zona activa</label>
            <select id="zoneSelect">
              <option value="none" selected>Sin zona</option>
              <option value="vip">VIP</option>
              <option value="preferencial">Preferencial</option>
              <option value="general">General</option>
              <option value="balcon">Balc√≥n</option>
            </select>
          </div>

          <div class="field field--two">
            <div>
              <label for="priceSeatInput">Precio silla</label>
              <input id="priceSeatInput" type="number" min="0" step="500" value="20000" />
            </div>
            <div>
              <label for="priceTableInput">Precio mesa</label>
              <input id="priceTableInput" type="number" min="0" step="500" value="80000" />
            </div>
          </div>

          <div class="row row--gap">
            <button class="btn btn--ghost" id="btnAssignZone" type="button" title="Asignar zona a selecci√≥n">
              Asignar zona
            </button>
            <button class="btn btn--ghost" id="btnClearZone" type="button" title="Quitar zona de selecci√≥n">
              Quitar zona
            </button>
          </div>

          <div class="note">
            Consejo: usa <strong>Modo Selecci√≥n</strong> para seleccionar varias celdas y luego asigna zona.
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Exportar / Importar</h2>
          <p class="panel__hint">Para compartir el plano o usarlo luego en backend.</p>
        </div>

        <div class="row row--gap">
          <button class="btn" id="btnExportJSON" type="button">Exportar JSON</button>
          <button class="btn btn--ghost" id="btnImportJSON" type="button">Importar JSON</button>
        </div>

        <div class="row row--gap">
          <button class="btn btn--ghost" id="btnExportCSV" type="button">Exportar CSV</button>
          <button class="btn btn--ghost" id="btnPrint" type="button">Imprimir</button>
        </div>

        <div class="note">
          Exportar no vende entradas; solo genera el dise√±o con datos (asiento, zona, precio base).
        </div>
      </section>
    </aside>

    <!-- =======================================================
         CENTER: CANVAS + GRID
    ======================================================== -->
    <main class="workspace" id="workspace" aria-label="√Årea de trabajo">
      <div class="workspace__top">
        <div class="stats" id="statsBar" aria-label="Estad√≠sticas del plano">
          <div class="stat">
            <span class="stat__label">Sillas</span>
            <span class="stat__value" id="statSeats">0</span>
          </div>
          <div class="stat">
            <span class="stat__label">Mesas</span>
            <span class="stat__value" id="statTables">0</span>
          </div>
          <div class="stat">
            <span class="stat__label">Capacidad</span>
            <span class="stat__value" id="statCapacity">0</span>
          </div>
          <div class="stat">
            <span class="stat__label">Seleccionadas</span>
            <span class="stat__value" id="statSelected">0</span>
          </div>
          <div class="stat">
            <span class="stat__label">Zona activa</span>
            <span class="stat__value" id="statZone">‚Äî</span>
          </div>
        </div>

        <div class="workspace__actions">
          <button class="btn btn--ghost" id="btnToggleGridLines" type="button" title="Mostrar/ocultar l√≠neas del grid">
            L√≠neas
          </button>
          <button class="btn btn--ghost" id="btnToggleLegend" type="button" title="Mostrar/ocultar leyenda">
            Leyenda
          </button>
        </div>
      </div>

      <div class="canvaswrap" id="canvasWrap">
        <div class="legend" id="legend" aria-label="Leyenda">
          <div class="legend__item"><span class="chip chip--seat"></span> Silla</div>
          <div class="legend__item"><span class="chip chip--table"></span> Mesa</div>
          <div class="legend__item"><span class="chip chip--stage"></span> Escenario</div>
          <div class="legend__item"><span class="chip chip--wall"></span> Bloque</div>
          <div class="legend__item"><span class="chip chip--aisle"></span> Pasillo</div>
          <div class="legend__item"><span class="chip chip--selected"></span> Selecci√≥n</div>
        </div>

        <!-- GRID -->
        <section class="grid" id="grid" aria-label="Plano del recinto" tabindex="0">
          <!-- Se genera por JS -->
        </section>
      </div>

      <div class="workspace__bottom">
        <div class="hintbar" id="hintBar">
          <span id="hintText">Consejo: selecciona una herramienta y haz clic/arrastra sobre el plano.</span>
        </div>
        <div class="statusbar" id="statusBar">
          <span class="muted">Archivo:</span> <span id="saveStateLabel">Sin guardar</span>
          <span class="dot" aria-hidden="true">‚Ä¢</span>
          <span class="muted">√öltima acci√≥n:</span> <span id="lastActionLabel">‚Äî</span>
        </div>
      </div>
    </main>

    <!-- =======================================================
         RIGHT SIDEBAR: INSPECTOR / DETAILS
    ======================================================== -->
    <aside class="sidebar sidebar--right" id="rightSidebar" aria-label="Inspector">
      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Inspector</h2>
          <p class="panel__hint">Detalles de la celda / selecci√≥n.</p>
        </div>

        <div class="inspector">
          <div class="inspector__row">
            <span class="muted">Tipo</span>
            <strong id="inspType">‚Äî</strong>
          </div>
          <div class="inspector__row">
            <span class="muted">Asiento #</span>
            <strong id="inspSeatNumber">‚Äî</strong>
          </div>
          <div class="inspector__row">
            <span class="muted">Zona</span>
            <strong id="inspZone">‚Äî</strong>
          </div>
          <div class="inspector__row">
            <span class="muted">Precio</span>
            <strong id="inspPrice">‚Äî</strong>
          </div>

          <hr class="hr" />

          <div class="field">
            <label for="inspPriceInput">Precio personalizado (selecci√≥n)</label>
            <input id="inspPriceInput" type="number" min="0" step="500" placeholder="Ej: 25000" />
          </div>

          <div class="row row--gap">
            <button class="btn btn--ghost" id="btnApplyPrice" type="button">Aplicar precio</button>
            <button class="btn btn--ghost" id="btnClearPrice" type="button">Quitar precio</button>
          </div>

          <hr class="hr" />

          <div class="field">
            <label for="sellModeSelect">Estado de venta (simulaci√≥n)</label>
            <select id="sellModeSelect">
              <option value="available" selected>Disponible</option>
              <option value="reserved">Reservado</option>
              <option value="sold">Vendido</option>
              <option value="blocked">Bloqueado</option>
            </select>
          </div>

          <div class="row row--gap">
            <button class="btn btn--ghost" id="btnApplySellState" type="button">Aplicar estado</button>
            <button class="btn btn--ghost" id="btnResetSellState" type="button">Reset estado</button>
          </div>

          <div class="note">
            Esto es ‚Äúpreparaci√≥n de venta‚Äù: no cobra, pero estructura la data para cuando exista checkout.
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panel__header">
          <h2 class="panel__title">Checklist MVP</h2>
          <p class="panel__hint">Lo que debe quedar listo antes de ‚Äúvender‚Äù.</p>
        </div>

        <ol class="checklist" id="mvpChecklist">
          <li><input type="checkbox" id="chkMvp1" /> <label for="chkMvp1">Plano editable (ok)</label></li>
          <li><input type="checkbox" id="chkMvp2" /> <label for="chkMvp2">Numeraci√≥n de asientos</label></li>
          <li><input type="checkbox" id="chkMvp3" /> <label for="chkMvp3">Zonas + precios</label></li>
          <li><input type="checkbox" id="chkMvp4" /> <label for="chkMvp4">Capacidad calculada</label></li>
          <li><input type="checkbox" id="chkMvp5" /> <label for="chkMvp5">Exportaci√≥n JSON</label></li>
        </ol>

        <div class="note">
          Cuando esto est√© completo, el equipo puede iniciar ‚Äúpreparar venta‚Äù (frontend cliente + backend).
        </div>
      </section>
    </aside>
  </div>

  <!-- =========================================================
       DIALOGS / MODALS
  ========================================================== -->

  <!-- Export JSON Modal -->
  <dialog class="modal" id="modalExport">
    <form method="dialog" class="modal__card">
      <div class="modal__header">
        <h3>Exportar dise√±o</h3>
        <button class="iconbtn" value="cancel" aria-label="Cerrar">‚úï</button>
      </div>

      <div class="modal__body">
        <p class="muted">Copia o descarga el JSON del layout.</p>

        <div class="row row--gap">
          <button class="btn" id="btnDownloadJSON" type="button">Descargar .json</button>
          <button class="btn btn--ghost" id="btnCopyJSON" type="button">Copiar</button>
        </div>

        <label for="exportTextarea" class="muted" style="display:block;margin-top:10px;">JSON</label>
        <textarea id="exportTextarea" class="codebox" spellcheck="false"></textarea>
      </div>

      <div class="modal__footer">
        <button class="btn btn--ghost" value="cancel">Cerrar</button>
      </div>
    </form>
  </dialog>

  <!-- Import JSON Modal -->
  <dialog class="modal" id="modalImport">
    <form method="dialog" class="modal__card">
      <div class="modal__header">
        <h3>Importar dise√±o</h3>
        <button class="iconbtn" value="cancel" aria-label="Cerrar">‚úï</button>
      </div>

      <div class="modal__body">
        <p class="muted">Pega el JSON exportado para reconstruir el layout.</p>

        <label for="importTextarea" class="muted" style="display:block;margin-top:10px;">JSON</label>
        <textarea id="importTextarea" class="codebox" spellcheck="false"></textarea>

        <div class="row row--gap" style="margin-top:10px;">
          <button class="btn" id="btnApplyImport" type="button">Importar</button>
          <button class="btn btn--ghost" id="btnCancelImport" type="button">Cancelar</button>
        </div>
      </div>

      <div class="modal__footer">
        <button class="btn btn--ghost" value="cancel">Cerrar</button>
      </div>
    </form>
  </dialog>

  <!-- Help Modal -->
  <dialog class="modal" id="modalHelp">
    <form method="dialog" class="modal__card">
      <div class="modal__header">
        <h3>Ayuda</h3>
        <button class="iconbtn" value="cancel" aria-label="Cerrar">‚úï</button>
      </div>

      <div class="modal__body">
        <p>
          Este editor sirve para dise√±ar recintos de eventos (sillas, mesas, escenario) y preparar la estructura de venta.
          Primero construyes el plano; despu√©s se exporta y se usa para tickets y pagos.
        </p>

        <ul>
          <li>Elige una herramienta y pinta sobre el plano.</li>
          <li>Activa ‚ÄúAuto-numerar‚Äù para numeraci√≥n autom√°tica de sillas.</li>
          <li>Usa ‚ÄúModo Selecci√≥n‚Äù para seleccionar varios elementos y asignar zona/precio.</li>
          <li>Guarda para no perder el trabajo.</li>
        </ul>
      </div>

      <div class="modal__footer">
        <button class="btn btn--ghost" value="cancel">Cerrar</button>
      </div>
    </form>
  </dialog>

  <!-- Shortcuts Modal -->
  <dialog class="modal" id="modalShortcuts">
    <form method="dialog" class="modal__card">
      <div class="modal__header">
        <h3>Atajos</h3>
        <button class="iconbtn" value="cancel" aria-label="Cerrar">‚úï</button>
      </div>

      <div class="modal__body">
        <ul class="kbdlist">
          <li><kbd>1</kbd> Silla</li>
          <li><kbd>2</kbd> Mesa</li>
          <li><kbd>3</kbd> Escenario</li>
          <li><kbd>4</kbd> Bloque</li>
          <li><kbd>5</kbd> Pasillo</li>
          <li><kbd>E</kbd> Borrar</li>
          <li><kbd>S</kbd> Guardar</li>
          <li><kbd>L</kbd> Cargar</li>
          <li><kbd>Ctrl</kbd> + <kbd>Z</kbd> Deshacer</li>
          <li><kbd>Ctrl</kbd> + <kbd>Y</kbd> Rehacer</li>
        </ul>
      </div>

      <div class="modal__footer">
        <button class="btn btn--ghost" value="cancel">Cerrar</button>
      </div>
    </form>
  </dialog>

  <!-- =========================================================
       NOSCRIPT FALLBACK
  ========================================================== -->
  <noscript>
    <div class="noscript">
      Este proyecto requiere JavaScript para funcionar. Act√≠valo en tu navegador.
    </div>
  </noscript>

  <!-- =========================================================
       JS ENTRYPOINT (MODULE)
  ========================================================== -->
  <script type="module" src="js/app.js?v=1"></script>
</body>
</html>
